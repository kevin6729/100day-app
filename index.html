<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  
  <title>100ì¼ ì±Œë¦°ì§€ - ìŠµê´€ ë§Œë“¤ê¸° ì•±</title>
  <meta name="description" content="ë§¤ì¼ ì²´í¬í•˜ë©´ì„œ ìŠµê´€ì„ ë§Œë“œëŠ” 100ì¼ ì±Œë¦°ì§€. ìš´ë™, ìì‚°ê´€ë¦¬, ë…ì„œ ëª©í‘œë¥¼ ë‹¬ì„±í•˜ì„¸ìš”.">
  <meta name="keywords" content="100ì¼ ì±Œë¦°ì§€, ìŠµê´€ ë§Œë“¤ê¸°, ì¬í…Œí¬ ìŠµê´€, ìê¸°ê³„ë°œ, ê²½ì œì  ììœ ">
  
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#4285F4">
  <link rel="apple-touch-icon" href="icon-192.png">
  <link rel="icon" type="image/png" sizes="192x192" href="icon-192.png">
  <link rel="icon" type="image/png" sizes="512x512" href="icon-512.png">
  
  <script>
    const isAdFree = window.location.search.includes('me') || localStorage.getItem('adFreeMode') === 'true';
    if (window.location.search.includes('me')) {
      localStorage.setItem('adFreeMode', 'true');
    }

    if (!isAdFree) {
      var script = document.createElement('script');
      script.async = true;
      script.src = "https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7617624533409809";
      script.crossOrigin = "anonymous";
      document.head.appendChild(script);
    }
  </script>
  
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Malgun Gothic', sans-serif; background: #f5f5f5; line-height: 1.6; }
    .app { max-width: 1000px; margin: 0 auto; padding: 10px; }
    .entry-screen { text-align: center; padding: 20px 20px 15px; background: #fff; border-radius: 20px; margin: 10px 0 10px 0; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
    .entry-screen h1 { font-size: 2rem; margin-bottom: 10px; color: #1a1a1b; font-weight: 700; }
    .btn-main { background: #4285F4; color: white; border: none; padding: 16px 35px; border-radius: 10px; font-weight: bold; cursor: pointer; font-size: 1.2rem; transition: 0.2s; }
    .quote-container { margin: 20px auto; padding: 20px 25px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 15px; color: white; text-align: center; }
    .summary-board { background: #1a1a1b; color: white; border-radius: 20px; padding: 30px; margin-bottom: 20px; }
    .summary-board h2 { color: #ff7a18; font-size: 1.6rem; border-left: 5px solid #ff7a18; padding-left: 15px; margin-bottom: 25px; }
    .summary-item { margin-bottom: 22px; }
    .summary-info { display: flex; justify-content: space-between; margin-bottom: 8px; font-weight: 600; }
    .summary-bar-bg { background: rgba(255,255,255,0.1); height: 12px; border-radius: 6px; overflow: hidden; }
    .summary-bar-fill { background: linear-gradient(90deg, #ff7a18 0%, #af002d 100%); height: 100%; transition: width 1s; }
    .project-card { background: #fff; border: 1px solid #eee; border-radius: 15px; padding: 25px; margin-bottom: 35px; box-shadow: 0 5px 15px rgba(0,0,0,0.05); }
    .grid-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
    .grid-container { display: grid; grid-template-columns: repeat(10, 1fr); gap: 5px; margin: 20px 0; }
    .day-cell { aspect-ratio: 1/1; background: #f0f0f0; border-radius: 4px; display: flex; align-items: center; justify-content: center; cursor: pointer; font-size: 10px; color: #777; transition: 0.2s; }
    .day-cell.done { background: #4CAF50; color: white; font-weight: bold; }
    .progress-bg { background: #eee; height: 8px; border-radius: 4px; margin: 10px 0; }
    .progress-fill { background: #1A73E8; height: 100%; transition: width 0.3s; }
    .del-btn { background: #fff0f0; border: 1px solid #ffcccc; color: #ff4444; padding: 5px 12px; border-radius: 6px; cursor: pointer; font-size: 11px; }
    .footer { background: #fff; border-radius: 20px; padding: 35px; margin-top: 10px; color: #444; }
    .highlight-box { background: #fff8f0; border-left: 4px solid #ff7a18; padding: 18px; margin: 20px 0; border-radius: 8px; }
    @media (max-width: 600px) { .grid-container { grid-template-columns: repeat(7, 1fr); } }
  </style>
</head>
<body>
  <div class="app">
    <div id="login-screen" class="entry-screen">
      <h1>ğŸ”¥ 100ì¼ ì±Œë¦°ì§€</h1>
      <p style="margin-bottom:20px;">ë§¤ì¼ ì²´í¬í•˜ê³  ëª©í‘œ ë‹¬ì„±!</p>
      <button class="btn-main" onclick="startAsGuest()">ğŸš€ ë°”ë¡œ ì‹œì‘í•˜ê¸°</button>

      <div id="ad-area" style="margin: 20px auto; text-align: center;">
        <ins class="adsbygoogle"
             style="display:block"
             data-ad-client="ca-pub-7617624533409809"
             data-ad-slot="2934193554"
             data-ad-format="auto"
             data-full-width-responsive="true"></ins>
        <script>
           if (!isAdFree) { (window.adsbygoogle = window.adsbygoogle || []).push({}); } 
           else { document.getElementById('ad-area').style.display = 'none'; }
        </script>
      </div>
    </div>

    <div id="main-screen" style="display:none;">
      <div id="backup-banner" class="backup-banner" style="background: linear-gradient(135deg, #FF9500 0%, #FF5E3A 100%); color: white; padding: 12px 20px; border-radius: 10px; margin-bottom: 15px; display: none; align-items: center; justify-content: space-between;">
        <div style="flex:1; font-size:0.9rem;">ğŸ’¾ <strong>ë°ì´í„° ë°±ì—…:</strong> ë¡œê·¸ì¸í•˜ì‹œë©´ ê¸°ë¡ì´ ì˜êµ¬ ë³´ê´€ë©ë‹ˆë‹¤!</div>
        <button onclick="loginWithGoogle()" style="background:white; color:#FF9500; border:none; padding:8px 16px; border-radius:6px; cursor:pointer; font-weight:bold; margin-left:10px;">ë¡œê·¸ì¸</button>
      </div>

      <div class="quote-container">
        <div id="quote-text" style="font-weight:600; margin-bottom:10px;"></div>
        <div id="quote-author" style="font-size:0.9rem; opacity:0.8;"></div>
      </div>

      <div class="summary-board">
        <h2 id="welcome-msg">ë‚˜ì˜ 100ì¼ ì±Œë¦°ì§€ í˜„í™©</h2>
        <div id="summary-list"></div>
      </div>

      <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:25px;">
        <h2 style="border-left:5px solid #ff7a18; padding-left:15px; font-size:1.4rem;">ë‚˜ì˜ ì±Œë¦°ì§€</h2>
        <button onclick="createNewChallenge()" style="background:#ff7a18; color:white; border:none; padding:10px 18px; border-radius:8px; cursor:pointer; font-weight:bold;">+ ì¶”ê°€</button>
      </div>
      
      <div id="challenge-list"></div>

      <div style="text-align: center; margin: 20px 0;">
        <button class="btn-share" onclick="shareApp()" style="background: #FF9500; color: white; border: none; padding: 12px 25px; border-radius: 8px; cursor: pointer; font-weight: bold;">ğŸ“¤ ì¹œêµ¬ì—ê²Œ ê³µìœ í•˜ê¸°</button>
      </div>
    </div>

    <div class="footer">
      <h2>100ì¼ ì±Œë¦°ì§€ ì•± ì™„ë²½ ê°€ì´ë“œ</h2>
      
      <div class="highlight-box">
        <p><strong>ğŸ’¡ TIP 1:</strong> ì±Œë¦°ì§€ <strong>ì œëª©ì„ í´ë¦­</strong>í•˜ë©´ ë‹¤ìŒ ë‚ ì§œê°€ ìë™ ì²´í¬ë©ë‹ˆë‹¤!</p>
        <p><strong>ğŸ“Š TIP 2:</strong> <strong>ì„±ì·¨ë„(%)ê°€ ë†’ì€</strong> ëª©í‘œê°€ ìë™ìœ¼ë¡œ ë§¨ ìœ„ì— í‘œì‹œë©ë‹ˆë‹¤.</p>
      </div>
      <p style="text-align: center; margin-bottom: 30px; font-weight: bold; color: #555;">
        ë§¤ì¼ì˜ ì‘ì€ ìŠµê´€ì´ ê²½ì œì  ììœ ì™€ ì„±ê³µìœ¼ë¡œ ê°€ëŠ” ê°€ì¥ í™•ì‹¤í•œ ê¸¸ì…ë‹ˆë‹¤.
      </p>

      <div class="highlight-box" style="background: #fff3e0; border-left: 5px solid #ff6b00;">
        <p style="font-size: 1.1rem; font-weight: bold; color: #ff6b00; margin-bottom: 12px;">âš  ì¸ì•± ë¸Œë¼ìš°ì €(ì¹´í†¡/ìŠ¤ë ˆë“œ) ì´ìš©ì í•„ë…!</p>
        <p>ì¸ì•± ë¸Œë¼ìš°ì €ì—ì„œëŠ” ë¡œê·¸ì¸ì´ ì°¨ë‹¨ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìš°ì¸¡ ìƒë‹¨ <strong>[â‹¯]</strong> -> <strong>"Safari/Chromeìœ¼ë¡œ ì—´ê¸°"</strong>ë¥¼ ì„ íƒí•´ ì£¼ì„¸ìš”.</p>
      </div>

      <h3>ğŸ“± ëª¨ë°”ì¼ì—ì„œ ì•±ì²˜ëŸ¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²•</h3>
      <div style="background: #f0f7ff; padding: 20px; border-radius: 10px; border-left: 5px solid #2196F3; margin: 20px 0;">
        <p>ë¸Œë¼ìš°ì € ë©”ë‰´ì—ì„œ <strong>'í™ˆ í™”ë©´ì— ì¶”ê°€'</strong>ë¥¼ ì„ íƒí•˜ë©´ ì‹¤ì œ ì•±ì²˜ëŸ¼ ì•„ì´ì½˜ì´ ìƒì„±ë˜ì–´ í¸ë¦¬í•©ë‹ˆë‹¤.</p>
      </div>

      <h3 style="margin-top: 40px;">ê²½ì œì  ììœ ë¥¼ ìœ„í•œ ìŠµê´€ íˆ¬ì ì „ëµ</h3>
      <p>ì„±ê³µì ì¸ ì¬í…Œí¬ì™€ ìì‚°ê´€ë¦¬ì˜ í•µì‹¬ì€ ì¼ê´€ì„± ìˆëŠ” ë£¨í‹´ì— ìˆìŠµë‹ˆë‹¤.</p>

      <div style="margin-top: 40px; padding: 35px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 20px; text-align: center; color: white;">
        <p style="font-size: 1.4rem; font-weight: bold;">ğŸ’¬ ë¶ˆí¸ì‚¬í•­ & ê±´ì˜ì‚¬í•­</p>
        <a href="https://www.threads.com/@lulluralral.come.on/post/DTFZmrHjxsA" target="_blank" style="display:inline-block; margin-top:20px; background:white; color:#667eea; padding:15px 35px; border-radius:12px; text-decoration:none; font-weight:bold;">ìŠ¤ë ˆë“œì— ì˜ê²¬ ë‚¨ê¸°ê¸°</a>
      </div>
    </div>
  </div>
  
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

  <script>
    // [ì‚¬ìš©ì ì›ë³¸ ëª…ì–¸ ë¦¬ìŠ¤íŠ¸] - ì§€ë©´ìƒ ìš”ì•½, ì›ë³¸ì—ì„œ ë³µì‚¬í•´ ë„£ìœ¼ì„¸ìš”.
    const quotes = [{ text: "ì„±ê³µì€ ë§¤ì¼ì˜ ì‘ì€ ë…¸ë ¥ì´ ëª¨ì—¬ ë§Œë“¤ì–´ì§‘ë‹ˆë‹¤", author: "ë¡œë²„íŠ¸ ì½œë¦¬ì–´" }, { text: "ìŠµê´€ì´ ë°”ë€Œë©´ ì¸ìƒì´ ë°”ë€ë‹¤", author: "ìµëª…" }];

    function showRandomQuote() {
      const q = quotes[Math.floor(Math.random() * quotes.length)];
      document.getElementById('quote-text').innerText = `"${q.text}"`;
      document.getElementById('quote-author').innerText = `- ${q.author}`;
    }
    showRandomQuote();

    firebase.initializeApp({
      apiKey: "AIzaSyBDGRyuJrcE1BSMY080yIHV1WJwUUGI_rs",
      authDomain: "miracle100-bfaf1.firebaseapp.com",
      projectId: "miracle100-bfaf1",
      storageBucket: "miracle100-bfaf1.firebasestorage.app",
      messagingSenderId: "367375464724",
      appId: "1:367375464724:web:6fccf8438a9a070f3aea01"
    });

    const db = firebase.firestore();
    const auth = firebase.auth();
    const STORAGE_KEY = 'challenge100_guest_data';
    let isGuestMode = false;

    async function loadChallenges(uid) {
      const snap = await db.collection('challenges').where('uid', '==', uid).get();
      let items = [];
      snap.forEach(doc => items.push({ id: doc.id, ...doc.data() }));
      items.sort((a, b) => (b.completedDays?.length || 0) - (a.completedDays?.length || 0));
      renderList(items);
    }

    function loadGuestChallenges() {
      const data = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');
      let sorted = data.map((d, i) => ({ ...d, originalIndex: i }))
                       .sort((a, b) => (b.completedDays?.length || 0) - (a.completedDays?.length || 0));
      renderList(sorted);
    }

    // [í•µì‹¬] ì œëª© í´ë¦­ ê¸°ëŠ¥ì´ ì¶”ê°€ëœ ë Œë”ë§ í•¨ìˆ˜
    function renderList(items) {
      const listDiv = document.getElementById('challenge-list');
      const summaryDiv = document.getElementById('summary-list');
      listDiv.innerHTML = ''; summaryDiv.innerHTML = '';

      items.forEach((item) => {
        const completedDays = item.completedDays || [];
        const progress = Math.round((completedDays.length / 100) * 100);
        const uniqueId = isGuestMode ? item.originalIndex : item.id;

        // 1. í˜„í™©íŒ(ëŒ€ì‹œë³´ë“œ) ì•„ì´í…œ ìƒì„±
        const summaryItem = document.createElement('div');
        summaryItem.className = 'summary-item';
        summaryItem.innerHTML = `
          <div class="summary-info">
            <span class="summary-click-title" style="cursor:pointer; text-decoration:underline; text-underline-offset:3px;">ğŸ”¥ ${item.title}</span>
            <span>${progress}%</span>
          </div>
          <div class="summary-bar-bg"><div class="summary-bar-fill" style="width:${progress}%"></div></div>`;
        summaryDiv.appendChild(summaryItem);

        // í˜„í™©íŒ ì œëª© í´ë¦­ ì´ë²¤íŠ¸
        summaryItem.querySelector('.summary-click-title').addEventListener('click', () => {
          isGuestMode ? toggleNextGuestDay(uniqueId, completedDays) : toggleNextDay(uniqueId, completedDays);
        });

        // 2. ì•„ë˜ìª½ ë¦¬ìŠ¤íŠ¸ ì¹´ë“œ ìƒì„±
        const card = document.createElement('div');
        card.className = 'project-card';
        card.innerHTML = `
          <div class="grid-header">
            <h3 class="c-title" style="cursor:pointer; text-decoration:underline;">${item.title}</h3>
            <button class="del-btn" onclick="deleteHandler('${uniqueId}')">ì‚­ì œ</button>
          </div>
          <div class="progress-bg"><div class="progress-fill" style="width:${progress}%"></div></div>
          <div class="grid-container" id="grid-${uniqueId}"></div>`;
        listDiv.appendChild(card);

        card.querySelector('.c-title').addEventListener('click', () => {
          isGuestMode ? toggleNextGuestDay(uniqueId, completedDays) : toggleNextDay(uniqueId, completedDays);
        });

        const grid = document.getElementById(`grid-${uniqueId}`);
        for (let i = 1; i <= 100; i++) {
          const cell = document.createElement('div');
          cell.className = `day-cell ${completedDays.includes(i) ? 'done' : ''}`;
          cell.innerText = i;
          cell.onclick = () => isGuestMode ? toggleGuestDay(uniqueId, i, completedDays) : toggleDay(uniqueId, i, completedDays);
          grid.appendChild(cell);
        }
      });
    }

    async function toggleNextDay(id, days) {
      const next = Array.from({length:100},(_,i)=>i+1).find(d => !days.includes(d));
      if(next) await toggleDay(id, next, days);
    }
    function toggleNextGuestDay(idx, days) {
      const next = Array.from({length:100},(_,i)=>i+1).find(d => !days.includes(d));
      if(next) toggleGuestDay(idx, next, days);
    }

    function startAsGuest() { isGuestMode = true; document.getElementById('login-screen').style.display='none'; document.getElementById('main-screen').style.display='block'; document.getElementById('backup-banner').style.display='flex'; loadGuestChallenges(); }
    async function loginWithGoogle() {
      const provider = new firebase.auth.GoogleAuthProvider();
      try {
        const result = await auth.signInWithPopup(provider);
        const guestData = localStorage.getItem(STORAGE_KEY);
        if (guestData && guestData !== '[]') await migrateData(result.user.uid);
        await loadChallenges(result.user.uid);
        document.getElementById('backup-banner').style.display='none'; isGuestMode=false;
      } catch (e) { alert("ë¡œê·¸ì¸ ì‹¤íŒ¨"); }
    }

    async function createNewChallenge() {
      const t = prompt("ëª©í‘œê°€ ë¬´ì—‡ì¸ê°€ìš”?"); if(!t) return;
      if(isGuestMode) {
        const d = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]'); d.push({title:t, completedDays:[]});
        localStorage.setItem(STORAGE_KEY, JSON.stringify(d)); loadGuestChallenges();
      } else {
        await db.collection('challenges').add({uid:auth.currentUser.uid, title:t, completedDays:[], createdAt:firebase.firestore.FieldValue.serverTimestamp()});
        loadChallenges(auth.currentUser.uid);
      }
    }
    async function toggleDay(id, day, days) {
      const newDays = days.includes(day) ? days.filter(d => d !== day) : [...days, day];
      await db.collection('challenges').doc(id).update({ completedDays: newDays });
      loadChallenges(auth.currentUser.uid);
    }
    function toggleGuestDay(idx, day, days) {
      const data = JSON.parse(localStorage.getItem(STORAGE_KEY));
      data[idx].completedDays = days.includes(day) ? days.filter(d => d !== day) : [...days, day];
      localStorage.setItem(STORAGE_KEY, JSON.stringify(data)); loadGuestChallenges();
    }
    function deleteHandler(id) { if(confirm("ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) { isGuestMode ? deleteGuestChallenge(id) : deleteChallenge(id); } }
    async function deleteChallenge(id) { await db.collection('challenges').doc(id).delete(); loadChallenges(auth.currentUser.uid); }
    function deleteGuestChallenge(idx) { const d = JSON.parse(localStorage.getItem(STORAGE_KEY)); d.splice(idx,1); localStorage.setItem(STORAGE_KEY, JSON.stringify(d)); loadGuestChallenges(); }
    function shareApp() { navigator.share({ title: '100ì¼ ì±Œë¦°ì§€', url: window.location.href }).catch(() => { alert("ë§í¬ ë³µì‚¬ ì™„ë£Œ"); }); }
  </script>
</body>
</html>
